---
category: 'Data Analysis'
tags: ['AD(s)P']
title: "[AD(s)P] 군집 분석 - 계층적군집 (Hierarchical Clustering)"
---

계층적군집 (Hierarchical Clustering)
: 가장 유사한 개체를 묶어 나가는 과정을 반복해 원하는 개수의 군집을 형성하는 방법

> 보통 계통도 또는 dendrogram의 형태로 결과가 주어지면 각 개체는 하나의 군집에서 속하게 됨

<br>


##  계층적군집 형성 방법

### 병합적(agglomerative) 방법
: 작은 군집에서 출발해 군집을 병합해 나가는 방법

> 한 개의 항목으로 시작해 매 단계마다 모든 그룹 쌍 간의 거리를 계산해 가까운 순으로 병합. 한 개 그룹만 남거나 종료 조건이 될 때까지 반복

<br>

### 분할적(divisive) 방법
: 큰 군집에서 출발해 군집을 분리해 나가는 방법

<br>


## 거리측정 방법 (병합방법)

### 최단연결법 또는 단일연결법 (single linkage method)
: 각 군집에서 하나씩 관측값을 뽑았을 때 나타날 수 있는 거리의 최소값으로 측정 -> 사슬 모양으로 생길 수 있음.

> 고립된 군집을 찾는데 중점을 둔 방법

<br>

### 최장연결법 또는 완전연결법 (complete linkage method)
: 각 군집에서 하나씩 관측값을 뽑았을 때 나타날 수 있는 거리의 최대값으로 측정

> 같은 군집에 속하는 관측치는 알려진 최대 거리보다 짧음.
>
> 군집들의 응집력에 중점을 둔 방법

<br>

### 중심연결법 (centroid linkage)
: 두 그룹의 중심 간의 거리를 측정

> 두 군집이 결합될 때 새로운 군집의 평균은 가중평균을 통해 구해짐

<br>

### 평균연결법 (Average linkage)
: 모든 항목에 대한 거리 평균을 구하면서 군집화

> 계산량이 불필요하게 많아질 수 있음

<br>

### 와드연결법 (Ward linkage)
: 군집들의 오차제곱합의 증가량이 가장 작아지는 방향으로 군집을 형성해 나감

> 크기가 비슷한 군집까지 병합하는 경향이 있음

<br>


## 거리 종류

### 연속형인 경우

#### Euclidian Distance (유클리드 거리)

$$d(i, j) = \sqrt{\sum_{f=1}{P} (x_{if} - x_{jf})^2}$$

<br>

#### 맨하튼(Manhattan) 또는 시가(City-block) 거리

$$d(i, j) = \sum_{f=1}{P} \mid x_{if} - x_{jf} \mid$$

<br>

#### 민코우스키(Minkowski) 거리

$$d(i, j) = \left(\sum_{f=1}{P} \mid x_{if} - x_{jf} \mid^m \right)^{1/m}$$

<br>

#### 표준화(Standardized) 거리

$$d(i, j) = \sqrt{(x_i - x_j)^T D^{-1} (x_i - x_j)}$$

<br>

#### Mahalanobis distance (마할라노비스 거리)

$$d(i, j) = \sqrt{(x_i - x_j)^T S^{-1} (x_i - x_j)}$$

<br>

#### Chebychev (체비세프) 거리

$$d(i, j) = max_f \mid x_{if} - x_{jf} \mid$$

<br>

#### 켄버라(Canberra) 거리

$$d(i, j) = \sum_{f=1}^{P} \frac{\mid x_{if} - x_{jf}\mid}{x_{if} + x_{jf}}$$

<br>

#### 코사인 거리 (유사성 측도)

$$d(x, y) = 1 - \frac{x \cdot y}{\|x\| \cdot \|y\|}$$

<br>

> 기타: 상관계수 등

<br>


### 명목형인 경우

d(i, j) = (개체 i와 j에서 다른 값을 가지는 변수의 수) / (총 변수의 수)

$$ d(i, j) = 1 - \frac{A \cap B}{A \cup B} = 1 - J(A, B)$$

> J(A, B) : 자카드 거리

- 명목형 -> 단순 일치 계수, 자카드 계수 등 이용
- 순서형 -> 순위 상관 계수 이용

<br>


## 계층적 군집 모형의 특징

- 군집을 형성하는 매 단계에서 지역적 최적화를 수행하기 때문에 그 결과가 전격적인 최적화라고 볼 수는 없음

- 병합접 방법에서 한 번 군집이 형성되면 군집에 속한 개체는 다른 군집으로 이동할 수 없음

- 중심연결법, 와드연결법 등에서는 군집 크기에 가중을 두어 병합하기 때문에 큰 군집과의 병합이 유도될 수 있음
